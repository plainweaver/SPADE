{"version":3,"sources":["../../src/utils/proxy-track.js"],"names":["callerMap","getCaller","error","stack","lines","split","length","match","name","replace","file","getFunctionName","fn","context","contextName","constructor","trackFunctionCall","options","target","thisArg","argumentsList","trackTime","trackCaller","trackCount","stdout","filter","Error","caller","start","end","Date","now","retVal","apply","output","canReport","type","count","time","console","log","trackPropertySet","set","prop","value","receiver","hashKey","Reflect","trackPropertyGet","get","proxyFunctions","trackedEntity","Object","getOwnPropertyNames","forEach","Proxy","trackObject","obj","trackFunctions","trackProps","resultObj","defineProperty","key","desc","setPrototypeOf","prototype","call","defaultOptions","trackClass","cls","construct","args","module","exports","proxyTrack","entity"],"mappings":"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","sourcesContent":["const callerMap = {};\n\nfunction getCaller(error) {\n  if (error && error.stack) {\n    const lines = error.stack.split('\\n');\n    if (lines.length > 2) {\n      let match = lines[2].match(/at ([a-zA-Z\\-_$.]+) (.*)/);\n      if (match) {\n        return {\n          name: match[1].replace(/^Proxy\\./, ''),\n          file: match[2],\n        };\n      } else {\n        match = lines[2].match(/at (.*)/);\n        if (match) {\n          return {\n            name: 'unknown',\n            file: match[1],\n          };\n        }\n      }\n    }\n  }\n  return {\n    name: 'unknown',\n    file: '',\n  };\n}\n\nfunction getFunctionName(fn, context) {\n  let contextName = '';\n  if (typeof context === 'function') {\n    contextName = `{context.name}.`;\n  } else if (context && context.constructor && context.constructor.name !== 'Object') {\n    contextName = `${context.constructor.name}.`;\n  }\n  return `${contextName}${fn.name}`;\n}\n\nfunction trackFunctionCall(options = {}) {\n  return function(target, thisArg, argumentsList) {\n    const { trackTime, trackCaller, trackCount, stdout, filter } = options;\n    const error = trackCaller && new Error();\n    const caller = getCaller(error);\n    const name = getFunctionName(target, thisArg);\n    if (trackCount) {\n      if (!callerMap[name]) {\n        callerMap[name] = 1;\n      } else {\n        callerMap[name]++;\n      }\n    }\n    let start, end;\n    if (trackTime) {\n      start = Date.now();\n    }\n    const retVal = target.apply(thisArg, argumentsList);\n    if (trackTime) {\n      end = Date.now();\n    }\n    let output = `${name} was called`;\n    if (trackCaller) {\n      output += ` by ${caller.name}`;\n    }\n    if (trackCount) {\n      output += ` for the ${callerMap[name]} time`;\n    }\n    if (trackTime) {\n      output += ` and took ${end-start} mils.`;\n    }\n    let canReport = true;\n    if (filter) {\n      canReport = filter({\n        type: 'function',\n        name,\n        caller,\n        count: callerMap[name],\n        time: end - start,\n      });\n    }\n    if (canReport) {\n      if (stdout) {\n        stdout(output);\n      } else {\n        console.log(output);\n      }\n    }\n    return retVal;\n  };\n}\n\nfunction trackPropertySet(options = {}) {\n  return function set(target, prop, value, receiver) {\n    const { trackCaller, trackCount, stdout, filter } = options;\n    const error = trackCaller && new Error();\n    const caller = getCaller(error);\n    const contextName = target.constructor.name === 'Object' ? '' : `${target.constructor.name}.`;\n    const name = `${contextName}${prop}`;\n    const hashKey = `set_${name}`;\n    if (trackCount) {\n      if (!callerMap[hashKey]) {\n        callerMap[hashKey] = 1;\n      } else {\n        callerMap[hashKey]++;\n      }\n    }\n    let output = `${name} is being set`;\n    if (trackCaller) {\n      output += ` by ${caller.name}`;\n    }\n    if (trackCount) {\n      output += ` for the ${callerMap[hashKey]} time`;\n    }\n    let canReport = true;\n    if (filter) {\n      canReport = filter({\n        type: 'get',\n        prop,\n        name,\n        caller,\n        count: callerMap[hashKey],\n        value,\n      });\n    }\n    if (canReport) {\n      if (stdout) {\n        stdout(output);\n      } else {\n        console.log(output);\n      }\n    }\n    return Reflect.set(target, prop, value, receiver);\n  };\n}\n\nfunction trackPropertyGet(options = {}) {\n  return function get(target, prop, receiver) {\n    const { trackCaller, trackCount, stdout, filter } = options;\n    if (typeof target[prop] === 'function' || prop === 'prototype') {\n      return target[prop];\n    }\n    const error = trackCaller && new Error();\n    const caller = getCaller(error);\n    const contextName = target.constructor.name === 'Object' ? '' : `${target.constructor.name}.`;\n    const name = `${contextName}${prop}`;\n    const hashKey = `get_${name}`;\n\n    if (trackCount) {\n      if (!callerMap[hashKey]) {\n        callerMap[hashKey] = 1;\n      } else {\n        callerMap[hashKey]++;\n      }\n    }\n    let output = `${name} is being get`;\n    if (trackCaller) {\n      output += ` by ${caller.name}`;\n    }\n    if (trackCount) {\n      output += ` for the ${callerMap[hashKey]} time`;\n    }\n    let canReport = true;\n    if (filter) {\n      canReport = filter({\n        type: 'get',\n        prop,\n        name,\n        caller,\n        count: callerMap[hashKey],\n      });\n    }\n    if (canReport) {\n      if (stdout) {\n        stdout(output);\n      } else {\n        console.log(output);\n      }\n    }\n    return target[prop];\n  };\n}\n\nfunction proxyFunctions(trackedEntity, options) {\n  if (typeof trackedEntity === 'function') return;\n  Object.getOwnPropertyNames(trackedEntity).forEach((name) => {\n    if (typeof trackedEntity[name] === 'function') {\n      trackedEntity[name] = new Proxy(trackedEntity[name], {\n        apply: trackFunctionCall(options),\n      });\n    }\n  });\n}\n\nfunction trackObject(obj, options = {}) {\n  const { trackFunctions, trackProps } = options;\n\n  let resultObj = obj;\n  if (trackFunctions) {\n    proxyFunctions(resultObj, options);\n  }\n  if (trackProps) {\n    resultObj = new Proxy(resultObj, {\n      get: trackPropertyGet(options),\n      set: trackPropertySet(options),\n      defineProperty: (target, key, desc) => {\n        console.log('asdf');\n        Reflect.defineProperty(target, key, desc);\n      },\n      setPrototypeOf: (target, prototype) => {\n        console.log('asdf');\n        Reflect.setPrototypeOf(target, prototype);\n      },\n      apply: trackFunctionCall(options),\n      call: trackFunctionCall(options)\n    });\n  }\n  return resultObj;\n}\n\nconst defaultOptions = {\n  trackFunctions: true,\n  trackProps: true,\n  trackTime: true,\n  trackCaller: true,\n  trackCount: true,\n  filter: null,\n};\n\nfunction trackClass(cls, options = {}) {\n  cls.prototype = trackObject(cls.prototype, options);\n  cls.prototype.constructor = cls;\n\n  return new Proxy(cls, {\n    construct(target, args) {\n      const obj = new target(...args);\n      return new Proxy(obj, {\n        get: trackPropertyGet(options),\n        set: trackPropertySet(options),\n        defineProperty(target, key, desc) {\n          console.log('asdf');\n          Reflect.defineProperty(target, key, desc);\n        },\n        setPrototypeOf(target, prototype) {\n          console.log('asdf');\n          Reflect.setPrototypeOf(target, prototype);\n        },\n        apply: trackFunctionCall(options),\n        call: trackFunctionCall(options)\n      });\n    },\n    apply: trackFunctionCall(options),\n  });\n}\n\nmodule.exports = function proxyTrack(entity, options = defaultOptions) {\n  if (typeof entity === 'function') return trackClass(entity, options);\n  return trackObject(entity, options);\n};"],"file":"proxy-track.js"}