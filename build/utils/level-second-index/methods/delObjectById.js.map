{"version":3,"sources":["../../../../src/utils/level-second-index/methods/delObjectById.js"],"names":["module","exports","delObjectById","objectId","object","stores","id","get","promises","Object","keys","map","key","Promise","resolve","then","ids","value","split","splice","indexOf","batch","type","all","del"],"mappings":";;AAAAA,MAAM,CAACC,OAAP,GAAiB,eAAeC,aAAf,CAA8BC,QAA9B,EAAwC;AACvD,QAAMC,MAAM,GAAG,MAAM,KAAKC,MAAL,CAAYC,EAAZ,CAAeC,GAAf,CAAmBJ,QAAnB,CAArB;AAEA,QAAMK,QAAQ,GAAGC,MAAM,CAACC,IAAP,CAAYN,MAAZ,EAAoBO,GAApB,CAAwBC,GAAG,IAAI;AAC9C;AACA,WAAOC,OAAO,CAACC,OAAR,GACJC,IADI,CACC,MAAM;AACV,aAAO,KAAKV,MAAL,CAAYO,GAAZ,EAAiBL,GAAjB,CAAqBH,MAAM,CAACQ,GAAD,CAA3B,CAAP;AACD,KAHI,EAIJG,IAJI,CAICC,GAAG,IAAI;AACX,YAAMC,KAAK,GAAGD,GAAG,CAACE,KAAJ,CAAU,GAAV,CAAd;AACAD,MAAAA,KAAK,CAACE,MAAN,CAAaF,KAAK,CAACG,OAAN,CAAcjB,QAAd,CAAb,EAAsC,CAAtC;AACA,aAAO,KAAKE,MAAL,CAAYO,GAAZ,EAAiBS,KAAjB,CAAuB,CAC5B;AAAEC,QAAAA,IAAI,EAAE,KAAR;AAAeV,QAAAA,GAAG,EAAER,MAAM,CAACQ,GAAD;AAA1B,OAD4B,EAE5B;AAAEU,QAAAA,IAAI,EAAE,KAAR;AAAeV,QAAAA,GAAG,EAAER,MAAM,CAACQ,GAAD,CAA1B;AAAiCK,QAAAA,KAAK,EAAEA;AAAxC,OAF4B,CAAvB,CAAP;AAID,KAXI,CAAP;AAYD,GAdgB,CAAjB;AAgBA,QAAMJ,OAAO,CAACU,GAAR,CAAYf,QAAZ,CAAN;AACA,QAAM,KAAKH,MAAL,CAAYC,EAAZ,CAAekB,GAAf,CAAmBrB,QAAnB,CAAN;AACD,CArBD","sourcesContent":["module.exports = async function delObjectById (objectId) {\n  const object = await this.stores.id.get(objectId);\n\n  const promises = Object.keys(object).map(key => {\n    // update object indices\n    return Promise.resolve()\n      .then(() => {\n        return this.stores[key].get(object[key]);\n      })\n      .then(ids => {\n        const value = ids.split(',');\n        value.splice(value.indexOf(objectId), 1);\n        return this.stores[key].batch([\n          { type: 'del', key: object[key] },\n          { type: 'put', key: object[key], value: value },\n        ]);\n      });\n  });\n\n  await Promise.all(promises);\n  await this.stores.id.del(objectId);\n};"],"file":"delObjectById.js"}