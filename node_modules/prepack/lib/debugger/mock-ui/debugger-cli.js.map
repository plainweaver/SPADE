{"version":3,"sources":["../../../src/debugger/mock-ui/debugger-cli.js"],"names":["run","process","console","args","readCLIArguments","session","UISession","serve","e","error","shutdown","adapterPath","prepackRuntime","prepackArguments","sourceFiles","Array","from","argv","splice","length","arg","shift","startsWith","exit","slice","split","push","concat","result"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) 2017-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n/* @flow strict-local */\n\nimport { UISession } from \"./UISession.js\";\nimport type { DebuggerCLIArguments } from \"./UISession.js\";\n/* The entry point to start up the debugger CLI\n * Reads in command line arguments and starts up a UISession\n*/\n\nfunction run(process, console) {\n  let args = readCLIArguments(process, console);\n  let session = new UISession(process, args);\n  try {\n    session.serve();\n  } catch (e) {\n    console.error(e);\n    session.shutdown();\n  }\n}\n\nfunction readCLIArguments(process, console): DebuggerCLIArguments {\n  let adapterPath = \"\";\n  let prepackRuntime = \"\";\n  let prepackArguments = [];\n  let sourceFiles = [];\n\n  let args = Array.from(process.argv);\n  args.splice(0, 2);\n  //read in the arguments\n  while (args.length > 0) {\n    let arg = args.shift();\n    if (!arg.startsWith(\"--\")) {\n      console.error(\"Invalid argument: \" + arg);\n      process.exit(1);\n    }\n    arg = arg.slice(2); // Slice off the -- prefix\n    if (arg === \"adapterPath\") {\n      adapterPath = args.shift();\n    } else if (arg === \"prepackRuntime\") {\n      prepackRuntime = args.shift();\n    } else if (arg === \"prepackArguments\") {\n      prepackArguments = args.shift().split(\" \");\n    } else if (arg === \"sourceFiles\") {\n      // Support multiple source files.\n      // Assumes everything between --sourceFile and the next --[flag] is a source file.\n      while (!arg.startsWith(\"--\")) {\n        sourceFiles.push(args.shift());\n        if (args.length === 0) break;\n        arg = args[0];\n      }\n    } else if (arg === \"diagnosticSeverity\") {\n      arg = args.shift();\n      if (arg !== \"FatalError\" && arg !== \"RecoverableError\" && arg !== \"Warning\" && arg !== \"Information\") {\n        console.error(\"Invalid debugger diagnostic severity level\");\n      }\n      prepackArguments = prepackArguments.concat([\"--debugDiagnosticSeverity\", `${arg}`]);\n    } else {\n      console.error(\"Unknown argument: \" + arg);\n      process.exit(1);\n    }\n  }\n\n  if (adapterPath.length === 0) {\n    console.error(\"No path to the debug adapter provided!\");\n    process.exit(1);\n  }\n  if (prepackRuntime.length === 0) {\n    console.error(\"No Prepack runtime given to start Prepack\");\n    process.exit(1);\n  }\n  if (sourceFiles.length === 0) {\n    console.error(\"No source code input file provided\");\n  }\n  let result: DebuggerCLIArguments = {\n    adapterPath: adapterPath,\n    prepackRuntime: prepackRuntime,\n    prepackArguments: prepackArguments,\n    sourceFiles: sourceFiles,\n  };\n  return result;\n}\nrun(process, console);\n"],"file":"debugger-cli.js"}