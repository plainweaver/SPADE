{"version":3,"sources":["../src/completions.js"],"names":["Completion","constructor","value","location","target","containsSelectedCompletion","selector","shallowClone","toDisplayString","name","makeAllNormalCompletionsResultInUndefined","completion","undefinedVal","$Realm","intrinsics","undefined","SimpleNormalCompletion","JoinedNormalAndAbruptCompletions","composedWith","consequent","alternate","makeSelectedCompletionsInfeasible","bottomValue","__bottomValue","JoinedAbruptCompletions","makeSelectedCompletionsInfeasibleInCopy","clone","normalizeSelectedCompletions","normalizedComposedWith","savedEffects","nc","na","AbruptCompletion","AbstractValue","createFromConditionalOp","joinCondition","NormalCompletion","result","ThrowCompletion","nativeStack","emitWarning","Error","stack","ContinueCompletion","BreakCompletion","ReturnCompletion","EmptyValue","empty","superString","slice","pathConditionsAtCreation","pathConditions"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) 2017-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree. An additional grant\n * of patent rights can be found in the PATENTS file in the same directory.\n */\n\n/* @flow */\n\nimport type { BabelNodeSourceLocation } from \"@babel/types\";\nimport invariant from \"./invariant.js\";\nimport type { Effects } from \"./realm.js\";\nimport { PathConditions } from \"./types.js\";\nimport { AbstractValue, EmptyValue, Value } from \"./values/index.js\";\n\nexport class Completion {\n  constructor(value: Value, location: ?BabelNodeSourceLocation, target?: ?string) {\n    this.value = value;\n    this.target = target;\n    this.location = location;\n    invariant(this.constructor !== Completion, \"Completion is an abstract base class\");\n  }\n\n  value: Value;\n  target: ?string;\n  location: ?BabelNodeSourceLocation;\n\n  containsSelectedCompletion(selector: Completion => boolean): boolean {\n    return selector(this);\n  }\n\n  shallowClone(): Completion {\n    invariant(false, \"abstract base method\");\n  }\n\n  toDisplayString(): string {\n    return \"[\" + this.constructor.name + \" value \" + (this.value ? this.value.toDisplayString() : \"undefined\") + \"]\";\n  }\n\n  static makeAllNormalCompletionsResultInUndefined(completion: Completion): void {\n    let undefinedVal = completion.value.$Realm.intrinsics.undefined;\n    if (completion instanceof SimpleNormalCompletion) completion.value = undefinedVal;\n    else if (completion instanceof JoinedNormalAndAbruptCompletions) {\n      if (completion.composedWith !== undefined)\n        Completion.makeAllNormalCompletionsResultInUndefined(completion.composedWith);\n      Completion.makeAllNormalCompletionsResultInUndefined(completion.consequent);\n      Completion.makeAllNormalCompletionsResultInUndefined(completion.alternate);\n    }\n  }\n\n  static makeSelectedCompletionsInfeasible(selector: Completion => boolean, completion: Completion): void {\n    let bottomValue = completion.value.$Realm.intrinsics.__bottomValue;\n    if (selector(completion)) completion.value = bottomValue;\n    else if (completion instanceof JoinedNormalAndAbruptCompletions || completion instanceof JoinedAbruptCompletions) {\n      if (completion instanceof JoinedNormalAndAbruptCompletions && completion.composedWith !== undefined)\n        Completion.makeSelectedCompletionsInfeasible(selector, completion.composedWith);\n      Completion.makeSelectedCompletionsInfeasible(selector, completion.consequent);\n      Completion.makeSelectedCompletionsInfeasible(selector, completion.alternate);\n    }\n  }\n\n  static makeSelectedCompletionsInfeasibleInCopy(selector: Completion => boolean, completion: Completion): Completion {\n    let bottomValue = completion.value.$Realm.intrinsics.__bottomValue;\n    let clone = completion.shallowClone();\n    if (selector(clone)) clone.value = bottomValue;\n    else if (clone instanceof JoinedNormalAndAbruptCompletions || clone instanceof JoinedAbruptCompletions) {\n      clone.consequent = (Completion.makeSelectedCompletionsInfeasibleInCopy(selector, clone.consequent): any);\n      clone.alternate = (Completion.makeSelectedCompletionsInfeasibleInCopy(selector, clone.alternate): any);\n      if (clone.consequent.value === bottomValue) {\n        return clone.alternate;\n      }\n      if (clone.alternate.value === bottomValue) {\n        return clone.consequent;\n      }\n    }\n    return clone;\n  }\n\n  static normalizeSelectedCompletions(selector: Completion => boolean, completion: Completion): Completion {\n    if (selector(completion)) return new SimpleNormalCompletion(completion.value);\n    let normalizedComposedWith;\n    if (completion instanceof JoinedNormalAndAbruptCompletions) {\n      invariant(completion.savedEffects === undefined); // caller should not used a still saved completion for this\n      if (completion.composedWith !== undefined)\n        normalizedComposedWith = Completion.normalizeSelectedCompletions(selector, completion.composedWith);\n    }\n    if (completion instanceof JoinedNormalAndAbruptCompletions || completion instanceof JoinedAbruptCompletions) {\n      let nc = Completion.normalizeSelectedCompletions(selector, completion.consequent);\n      let na = Completion.normalizeSelectedCompletions(selector, completion.alternate);\n      if (normalizedComposedWith === undefined) {\n        if (nc === completion.consequent && na === completion.alternate) return completion;\n        if (nc instanceof AbruptCompletion && na instanceof AbruptCompletion) return completion;\n        if (nc instanceof SimpleNormalCompletion && na instanceof SimpleNormalCompletion)\n          return new SimpleNormalCompletion(\n            AbstractValue.createFromConditionalOp(completion.value.$Realm, completion.joinCondition, nc.value, na.value)\n          );\n        invariant(nc instanceof AbruptCompletion || nc instanceof NormalCompletion);\n        invariant(na instanceof AbruptCompletion || na instanceof NormalCompletion);\n        return new JoinedNormalAndAbruptCompletions(completion.joinCondition, nc, na);\n      }\n      invariant(nc instanceof AbruptCompletion || nc instanceof NormalCompletion);\n      invariant(na instanceof AbruptCompletion || na instanceof NormalCompletion);\n      let result = new JoinedNormalAndAbruptCompletions(completion.joinCondition, nc, na);\n      if (normalizedComposedWith instanceof JoinedNormalAndAbruptCompletions)\n        result.composedWith = normalizedComposedWith;\n      return result;\n    }\n    return completion;\n  }\n}\n\n// Normal completions are returned just like spec completions\nexport class NormalCompletion extends Completion {\n  constructor(value: Value, location: ?BabelNodeSourceLocation, target?: ?string) {\n    super(value, location, target);\n    invariant(this.constructor !== NormalCompletion, \"NormalCompletion is an abstract base class\");\n  }\n}\n\n// SimpleNormalCompletions are returned just like spec completions.\n// They chiefly exist for use in joined completions.\nexport class SimpleNormalCompletion extends NormalCompletion {\n  shallowClone(): SimpleNormalCompletion {\n    return new SimpleNormalCompletion(this.value, this.location, this.target);\n  }\n}\n\n// Abrupt completions are thrown as exeptions, to make it a easier\n// to quickly get to the matching high level construct.\nexport class AbruptCompletion extends Completion {\n  constructor(value: Value, location: ?BabelNodeSourceLocation, target?: ?string) {\n    super(value, location, target);\n    invariant(this.constructor !== AbruptCompletion, \"AbruptCompletion is an abstract base class\");\n  }\n}\n\nexport class ThrowCompletion extends AbruptCompletion {\n  constructor(value: Value, location: ?BabelNodeSourceLocation, nativeStack?: ?string, emitWarning?: boolean = true) {\n    super(value, location);\n    this.nativeStack = nativeStack || new Error().stack;\n  }\n\n  nativeStack: string;\n\n  shallowClone(): ThrowCompletion {\n    return new ThrowCompletion(this.value, this.location, this.nativeStack, false);\n  }\n}\n\nexport class ContinueCompletion extends AbruptCompletion {\n  constructor(value: Value, location: ?BabelNodeSourceLocation, target: ?string) {\n    super(value, location, target || null);\n  }\n\n  shallowClone(): ContinueCompletion {\n    return new ContinueCompletion(this.value, this.location, this.target);\n  }\n}\n\nexport class BreakCompletion extends AbruptCompletion {\n  constructor(value: Value, location: ?BabelNodeSourceLocation, target: ?string) {\n    super(value, location, target || null);\n  }\n\n  shallowClone(): BreakCompletion {\n    return new BreakCompletion(this.value, this.location, this.target);\n  }\n}\n\nexport class ReturnCompletion extends AbruptCompletion {\n  constructor(value: Value, location: ?BabelNodeSourceLocation) {\n    super(value, location);\n    if (value instanceof EmptyValue) {\n      this.value = value.$Realm.intrinsics.undefined;\n    }\n  }\n\n  shallowClone(): ReturnCompletion {\n    return new ReturnCompletion(this.value, this.location);\n  }\n}\n\nexport class JoinedAbruptCompletions extends AbruptCompletion {\n  constructor(joinCondition: AbstractValue, consequent: AbruptCompletion, alternate: AbruptCompletion) {\n    super(joinCondition.$Realm.intrinsics.empty, consequent.location);\n    this.joinCondition = joinCondition;\n    this.consequent = consequent;\n    this.alternate = alternate;\n  }\n\n  joinCondition: AbstractValue;\n  consequent: AbruptCompletion;\n  alternate: AbruptCompletion;\n\n  containsSelectedCompletion(selector: Completion => boolean): boolean {\n    if (selector(this.consequent)) return true;\n    if (selector(this.alternate)) return true;\n    if (this.consequent instanceof JoinedAbruptCompletions) {\n      if (this.consequent.containsSelectedCompletion(selector)) return true;\n    }\n    if (this.alternate instanceof JoinedAbruptCompletions) {\n      if (this.alternate.containsSelectedCompletion(selector)) return true;\n    }\n    return false;\n  }\n\n  shallowClone(): JoinedAbruptCompletions {\n    return new JoinedAbruptCompletions(this.joinCondition, this.consequent, this.alternate);\n  }\n\n  toDisplayString(): string {\n    let superString = super.toDisplayString().slice(0, -1);\n    return (\n      superString + \" c: [\" + this.consequent.toDisplayString() + \"] a: [\" + this.alternate.toDisplayString() + \"]]\"\n    );\n  }\n}\n\n// This should never be thrown, therefore it is treated as a NormalCompletion even though it is also Abrupt.\nexport class JoinedNormalAndAbruptCompletions extends NormalCompletion {\n  constructor(\n    joinCondition: AbstractValue,\n    consequent: AbruptCompletion | NormalCompletion,\n    alternate: AbruptCompletion | NormalCompletion\n  ) {\n    super(consequent instanceof NormalCompletion ? consequent.value : alternate.value, consequent.location);\n    this.joinCondition = joinCondition;\n    this.consequent = consequent;\n    this.alternate = alternate;\n    this.pathConditionsAtCreation = joinCondition.$Realm.pathConditions;\n  }\n\n  joinCondition: AbstractValue;\n  consequent: AbruptCompletion | NormalCompletion;\n  alternate: AbruptCompletion | NormalCompletion;\n  // A completion that precedes this one and that has one or more normal paths, as well as some abrupt paths\n  composedWith: void | JoinedNormalAndAbruptCompletions;\n  pathConditionsAtCreation: PathConditions;\n  savedEffects: void | Effects;\n\n  containsSelectedCompletion(selector: Completion => boolean): boolean {\n    if (this.composedWith !== undefined && this.composedWith.containsSelectedCompletion(selector)) return true;\n    if (selector(this.consequent)) return true;\n    if (selector(this.alternate)) return true;\n    if (\n      this.consequent instanceof JoinedAbruptCompletions ||\n      this.consequent instanceof JoinedNormalAndAbruptCompletions\n    ) {\n      if (this.consequent.containsSelectedCompletion(selector)) return true;\n    }\n    if (\n      this.alternate instanceof JoinedAbruptCompletions ||\n      this.alternate instanceof JoinedNormalAndAbruptCompletions\n    ) {\n      if (this.alternate.containsSelectedCompletion(selector)) return true;\n    }\n    return false;\n  }\n\n  shallowClone(): JoinedNormalAndAbruptCompletions {\n    let clone = new JoinedNormalAndAbruptCompletions(this.joinCondition, this.consequent, this.alternate);\n    clone.composedWith = this.composedWith;\n    clone.pathConditionsAtCreation = this.pathConditionsAtCreation;\n    return clone;\n  }\n\n  toDisplayString(): string {\n    let superString = super.toDisplayString().slice(0, -1);\n    return (\n      superString + \" c: [\" + this.consequent.toDisplayString() + \"] a: [\" + this.alternate.toDisplayString() + \"]]\"\n    );\n  }\n}\n"],"file":"completions.js"}